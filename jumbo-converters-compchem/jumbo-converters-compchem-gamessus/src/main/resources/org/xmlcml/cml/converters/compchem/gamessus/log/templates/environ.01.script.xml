<template id="environ.01.script" repeat="*" name="GAMESS execution script"
  newline="$"
  pattern="\s*\-+\s*GAMESS execution script\s*\-+.*"
  endPattern="\s*">

  <comment class="example.input" id="environ.01.script1">
----- GAMESS execution script -----
This job is running on host s04c3b08
under operating system Linux at Thu Jun 12 13:14:43 CEST 2008
Available scratch disk space (Kbyte units) at beginning of the job is
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/gpfs_scratch    3898716160 119676928 3779039232   4% /gpfs/scratch
  </comment>
  <comment class="example.input" id="environ.01.script2">
----- GAMESS execution script -----
This job is running on host cl221
under operating system Linux at Fri Jul 11 15:57:47 NDT 2014
Available scratch disk space (Kbyte units) at beginning of the job is
Filesystem           1K-blocks      Used Available Use% Mounted on
samqfs://scratch/ostueker
                     8586374784 7421998816 1164375968  87% /globalscratch/ostueker
  </comment>

  <record/>
  <record id="host">\s*This job is running on host\s+{A,cc:hostname}\s*$</record>
  <record id="date">\s*under operating system Linux at\s+{X,cc:run.date}\s*$</record>
  <record repeat="*" id="scr">{X,g:script}</record>

  <transform process="createWrapperParameter"
              xpath=".//cml:scalar[@dictRef='cc:hostname' or @dictRef='cc:run.date' ]" />

  <transform process="addChild" xpath="."
                 elementName="cml:parameterList" position="0" />

  <transform process="move" to="./cml:parameterList"    xpath=".//cml:parameter[./cml:scalar]" />


  <transform process="delete" xpath=".//cml:scalar[@dictRef='g:script']"/> <!-- TODO: Maybe keep -->

 <!-- Delete empty lists -->
  <transform process="delete" xpath=".//cml:list[count(*)=0]"/>
  <transform process="delete" xpath=".//cml:list[count(*)=0]"/>



  <comment class="example.output" id="environ.01.script1">
    <module cmlx:templateRef="environ.01.script" xmlns="http://www.xml-cml.org/schema" xmlns:cmlx="http://www.xml-cml.org/schema/cmlx">
      <parameterList>
        <parameter dictRef="cc:hostname">
          <scalar dataType="xsd:string">s04c3b08</scalar>
        </parameter>
        <parameter dictRef="cc:run.date">
          <scalar dataType="xsd:string">Thu Jun 12 13:14:43 CEST 2008</scalar>
        </parameter>
      </parameterList>
    </module>
  </comment>

  <comment class="example.output" id="environ.01.script2">
	<module cmlx:templateRef="environ.01.script" xmlns="http://www.xml-cml.org/schema" xmlns:cmlx="http://www.xml-cml.org/schema/cmlx">
		<parameterList>
			<parameter dictRef="cc:hostname">
				<scalar dataType="xsd:string">cl221</scalar>
			</parameter>
			<parameter dictRef="cc:run.date">
				<scalar dataType="xsd:string">Fri Jul 11 15:57:47 NDT 2014</scalar>
			</parameter>
		</parameterList>
	</module>
  </comment>

</template>



