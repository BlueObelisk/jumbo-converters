<template repeat="*"  id="basis" name="Basis" 
  pattern="\s*Basis\s*.*$\s+\-+.*" newline="$" endPattern="\s*$\s*$\s*"
  endOffset="3"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  >
  <comment class="example.input" id="basis">
                      Basis "ao basis" -> "" (cartesian)
                      -----
  o (Oxygen)
  ----------
            Exponent  Coefficients 
       -------------- ---------------------------------------------------------
  1 S  5.22290220E+03 -0.001936
  1 S  7.82539940E+02 -0.014851
  1 S  1.77267430E+02 -0.073319
  1 S  4.95166880E+01 -0.245116
  1 S  1.56664400E+01 -0.480285
  1 S  5.17935990E+00 -0.335943

  2 S  1.06014410E+01  0.078806
  2 S  9.42317000E-01 -0.567695

  3 S  2.77474600E-01  1.000000
 
  h (Hydrogen)
  ------------
            Exponent  Coefficients 
       -------------- ---------------------------------------------------------
  1 S  3.38650000E+01  0.025494
  1 S  5.09479000E+00  0.190373
  1 S  1.15879000E+00  0.852161
 
  2 S  3.25840000E-01  1.000000
 
  3 S  1.02741000E-01  1.000000
 


  </comment>
  <record id="basis.title">\s*Basis\s*{X,n:basis.title}</record>
  <record/>
  <templateList>
    <!--  these atoms are terminated by the next atom -->
     <xi:include href="atombasis.xml"/>
    <!--  the last atom is terminated by 2 blank lines -->
     <xi:include href="atombasisend.xml"/>
  </templateList>
  
  <transform process="pullup" xpath=".//cml:module[@cmlx:templateRef='shell']"/>
  <transform process="pullup" xpath=".//cml:list[@cmlx:templateRef='atom']/cml:list/*"/>
  <transform process="pullup" xpath=".//cml:scalar[@dictRef='n:basis.title']"/>
  <transform process="delete" xpath=".//cml:module[@cmlx:templateRef='basis.shell' and count(*)=0]"/>
  <transform process="pullup" xpath=".//*[@cmlx:templateRef='atom']/cml:scalar"/>
  <transform process="pullup" xpath=".//cml:list[@cmlx:templateRef='row']"/>
  <transform process="delete" xpath=".//cml:module[@cmlx:templateRef='shell' and count(*)=0]"/>
  
  <comment class="example.output" id="basis">
<module cmlx:templateRef="basis" xmlns="http://www.xml-cml.org/schema" xmlns:cmlx="http://www.xml-cml.org/schema/cmlx">
  <scalar dataType="xsd:string" dictRef="n:basis.title">"ao basis" -&gt; "" (cartesian)</scalar>
  <module cmlx:lineCount="16" cmlx:templateRef="atombasis">
    <scalar dataType="xsd:string" dictRef="n:tag">o</scalar>
    <scalar dataType="xsd:string" dictRef="n:elementName">Oxygen</scalar>
    <list cmlx:templateRef="row">
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">1</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">5222.9022</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">-0.001936</scalar>
      </list>
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">1</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">782.53994</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">-0.014851</scalar>
      </list>
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">1</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">177.26743</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">-0.073319</scalar>
      </list>
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">1</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">49.516688</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">-0.245116</scalar>
      </list>
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">1</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">15.66644</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">-0.480285</scalar>
      </list>
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">1</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">5.1793599</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">-0.335943</scalar>
      </list>
    </list>
    <list cmlx:templateRef="row">
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">2</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">10.601441</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">0.078806</scalar>
      </list>
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">2</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">0.942317</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">-0.567695</scalar>
      </list>
    </list>
    <list cmlx:templateRef="row">
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">3</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">0.2774746</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">1.0</scalar>
      </list>
    </list>
  </module>
  <module cmlx:lineCount="14" cmlx:templateRef="atombasisend">
    <scalar dataType="xsd:string" dictRef="n:tag">h</scalar>
    <scalar dataType="xsd:string" dictRef="n:elementName">Hydrogen</scalar>
    <list cmlx:templateRef="row">
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">1</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">33.865</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">0.025494</scalar>
      </list>
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">1</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">5.09479</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">0.190373</scalar>
      </list>
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">1</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">1.15879</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">0.852161</scalar>
      </list>
    </list>
    <list cmlx:templateRef="row">
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">2</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">0.32584</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">1.0</scalar>
      </list>
    </list>
    <list cmlx:templateRef="row">
      <list>
        <scalar dataType="xsd:integer" dictRef="cc:basis.shellnum">3</scalar>
        <scalar dataType="xsd:string" dictRef="cc:shellsym">S</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.exponent">0.102741</scalar>
        <scalar dataType="xsd:double" dictRef="cc:basis.coefficient">1.0</scalar>
      </list>
    </list>
  </module>
</module>
  </comment>

</template>
