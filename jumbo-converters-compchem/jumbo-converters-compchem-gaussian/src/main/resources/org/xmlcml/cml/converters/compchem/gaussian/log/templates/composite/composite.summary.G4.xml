<template
  id="composite.summary.G4"
  name="Composite Method G4 - Summary"
  repeat="*"
  newline="$" 
  pattern="\s*Temperature=.+$.+$.+$.+$.+$.+$.+$\s+1\\1\\GINC.+\\Mixed\\G4\\.+"
  offset="0"
  endPattern=".+\\.+"
  endOffset="-1"
  xmlns:xi="http://www.w3.org/2001/XInclude">

  <comment class="example.input" id="composite.summary.G4">
 Temperature=              298.150000 Pressure=                      1.000000
 E(ZPE)=                     0.050464 E(Thermal)=                    0.053793
 E(CCSD(T))=              -115.374477 E(Empiric)=                   -0.048629
 DE(Plus)=                  -0.012030 DE(2DF)=                      -0.110133
 E(Delta-G3XP)=             -0.143944 DE(HF)=                       -0.013006
 G4(0 K)=                 -115.651756 G4 Energy=                  -115.648428
 G4 Enthalpy=             -115.647483 G4 Free Energy=             -115.674501
  </comment>

  <record id="G4.Temp.Press"     repeat="1">\s*Temperature=\s*{F,cc:temperature}\s+Pressure=\s*{F,cc:pressure}\s*</record>
  <record id="G4.contributions1" repeat="1">\s*E\(ZPE\)=\s*{F,g:E_ZPE}\s+E\(Thermal\)=\s*{F,g:E_Thermal}\s*</record>
  <record id="G4.contributions2" repeat="1">\s*E\(CCSD\(T\)\)=\s*{F,g:E_CCSD_T}\s+E\(Empiric\)=\s*{F,g:E_Empiric}\s*</record>
  <record id="G4.contributions3" repeat="1">\s*DE\(Plus\)=\s*{F,g:DE_Plus}\s+DE\(2DF\)=\s*{F,g:DE_2DF}\s*</record>
  <record id="G4.contributions4" repeat="1">\s*E\(Delta-G3XP\)=\s*{F,g:E_Delta-G3XP}\s+DE\(HF\)=\s*{F,g:DE_HF}\s*</record>
  <record id="G4a"               repeat="1">\s*G4\(0 K\)=\s*{F,g:Energy_G4_0K}\s+G4 Energy=\s*{F,g:Energy_G4}\s*$</record>
  <record id="G4b"               repeat="1">\s*G4 Enthalpy=\s*{F,g:Enthalpy_G4}\s+G4 Free Energy=\s*{F,g:GibbsEnergy_G4}\s*</record>

  <!-- Pull up scalars -->
  <transform process="pullup" xpath=".//cml:list/cml:scalar[@dictRef]" repeat="2" />

  <!-- Delete empty lists -->
  <transform process="delete"     xpath=".//cml:list[count(*)=0]"/>
  <transform process="delete"     xpath=".//cml:list[count(*)=0]"/>

  <!-- Improve some dictrefs -->
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:E_ZPE']"          value="cc:ZeroPointEnergy"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:E_Thermal']"      value="cc:thermalCorrectionToEnergy"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:E_CCSD_T']"       value="g:E_CCSD(T)"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:Energy_G4_0K']"   value="cc:Energy(0K)"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:Energy_G4']"      value="cc:Energy(T)"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:Enthalpy_G4']"    value="cc:Enthalpy(T)"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:GibbsEnergy_G4']" value="cc:GibbsEnergy(T)"/>
  
  <!-- Add units -->
  <transform process="addUnits"   xpath="./cml:scalar[@dictRef]"                  value="nonSi:hartree"/>
  <transform process="addUnits"   xpath="./cml:scalar[@dictRef='cc:temperature']" value="si:kelvin"/>
  <transform process="addUnits"   xpath="./cml:scalar[@dictRef='cc:pressure']"    value="nonSi:atm"/>

  <!-- group scalars in a list -->
  <transform process="addChild" elementName="cml:property" dictRef="g:composite_G4" xpath="." position="0"  />
  <transform process="addChild" elementName="cml:list"     xpath="./cml:property[@dictRef='g:composite_G4']" position="0" />
  <transform process="move"     xpath="./cml:scalar[@dictRef]"  to="./cml:property[@dictRef='g:composite_G4']/cml:list" />
  
  <comment class="example.output" id="composite.summary.G4">
  <module cmlx:templateRef="composite.summary.G4" xmlns="http://www.xml-cml.org/schema" xmlns:cmlx="http://www.xml-cml.org/schema/cmlx">
  <property dictRef="g:composite_G4">
    <list>
    <scalar dataType="xsd:double" units="si:kelvin"     dictRef="cc:temperature"              >298.15</scalar>
    <scalar dataType="xsd:double" units="nonSi:atm"     dictRef="cc:pressure"                 >1.0</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="cc:ZeroPointEnergy"          >0.050464</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="cc:thermalCorrectionToEnergy">0.053793</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="g:E_CCSD(T)"                 >-115.374477</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="g:E_Empiric"                 >-0.048629</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="g:DE_Plus"                   >-0.01203</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="g:DE_2DF"                    >-0.110133</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="g:E_Delta-G3XP"              >-0.143944</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="g:DE_HF"                     >-0.013006</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="cc:Energy(0K)"               >-115.651756</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="cc:Energy(T)"                >-115.648428</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="cc:Enthalpy(T)"              >-115.647483</scalar>
    <scalar dataType="xsd:double" units="nonSi:hartree" dictRef="cc:GibbsEnergy(T)"           >-115.674501</scalar>
    </list>
  </property>
  </module>
  </comment>

</template>