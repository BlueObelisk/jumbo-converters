<template id="l9999.archive" name="Gaussian archive" repeat="*"
    pattern="\s*1\\1\\.*" 
    endPattern=".*\\\\@\s*" endOffset="1"
    >
    
  <comment class="example.input" id="l9999.archive">
 1\1\GINC-DEEPTHOUGHT\Freq\RB3LYP\6-31G(d)\C1H4\WWW-DATA\20-Nov-2006\0\
 \#N GEOM=ALLCHECK GUESS=READ SCRF=CHECK GENCHK RB3LYP/6-31G(D) FREQ\\C
 H4\\0,1\C,0.,0.,0.\H,0.0000000995,0.0000001925,1.09326594\H,1.03074097
 99,0.0000001096,-0.3644220738\H,-0.5153703892,-0.8926480531,-0.3644217
 759\H,-0.5153706902,0.892647751,-0.3644220902\\Version=x86-Linux-G03Re
 vB.04\State=1-A1\HF=-40.5183892\RMSD=8.723e-11\RMSF=8.224e-08\Dipole=0
 .,0.,0.\DipoleDeriv=0.0007872,0.,0.,0.,0.0007871,0.,0.,0.,0.0007871,0.
 0733391,0.,0.,0.,0.0733391,0.,0.,0.,-0.1472685,-0.1227565,0.,0.0693303
 ,0.,0.0733391,0.,0.0693303,0.,0.0488271,0.0243152,-0.0849119,-0.034665
 1,-0.0849119,-0.0737327,-0.0600418,-0.0346651,-0.0600418,0.0488271,0.0
 243151,0.0849119,-0.0346652,0.0849119,-0.0737326,0.0600418,-0.0346652,
 0.0600418,0.0488271\Polar=12.3528403,0.,12.3528403,0.,0.,12.3528403\PG
 =TD [O(C1),4C3(H1)]\NImag=0\\0.55936081,0.,0.55936081,0.,0.,0.55936081
 ,-0.04828560,0.,-0.00000003,0.04683066,0.,-0.04828560,-0.00000005,0.,0
 .04683066,-0.00000003,-0.00000005,-0.32294941,0.00000003,0.00000005,0.
 34888521,-0.29243119,-0.00000003,0.08631853,0.00266595,0.,-0.00067139,
 0.31532358,-0.00000003,-0.04828560,0.,0.,-0.00169598,0.,0.00000003,0.0
 4683066,0.08631853,0.,-0.07880382,0.03266432,0.,-0.00864527,-0.0949266
 1,-0.00000001,0.08039229,-0.10932197,-0.10571814,-0.04315922,-0.000605
 50,0.00188877,0.00033570,-0.01277916,-0.02604072,-0.01202812,0.1139538
 6,-0.10571814,-0.23139487,-0.07475399,0.00188877,0.00157546,0.00058144
 ,0.00117778,0.00157546,0.00158693,0.11626084,0.24820043,-0.04315922,-0
 .07475399,-0.07880377,-0.01633216,-0.02828814,-0.00864526,0.00463974,0
 .01121013,0.00352839,0.04746326,0.08220880,0.08039224,-0.10932205,0.10
 571817,-0.04315928,-0.00060550,-0.00188877,0.00033570,-0.01277917,0.02
 604071,-0.01202812,0.00875278,-0.01360924,0.00738839,0.11395394,0.1057
 1817,-0.23139475,0.07475403,-0.00188877,0.00157547,-0.00058144,-0.0011
 7778,0.00157546,-0.00158694,0.01360926,-0.01995648,0.00962320,-0.11626
 087,0.24820029,-0.04315928,0.07475403,-0.07880382,-0.01633217,0.028288
 13,-0.00864527,0.00463974,-0.01121013,0.00352840,0.00738838,-0.0096231
 9,0.00352839,0.04746332,-0.08220885,0.08039230\\0.,0.,0.,0.,0.,0.00000
 016,0.00000015,0.,-0.00000005,-0.00000008,-0.00000013,-0.00000005,-0.0
 0000008,0.00000013,-0.00000005\\\@

  </comment>
  <record repeat="*" id="ginc">\s{X,g:ginc1}</record>

  <transform process="createString" xpath="./cml:list/cml:scalar"/>
  <transform process="split" xpath="./cml:list/cml:scalar" splitter="\\\\" dictRef="g:archive"/>
  <transform process="addDictRef" xpath="./cml:list/cml:list/cml:scalar[1]" value="g:archive1"/>
  <transform process="addDictRef" xpath="./cml:list/cml:list/cml:scalar[2]" value="cc:keywords"/>
  <transform process="addDictRef" xpath="./cml:list/cml:list/cml:scalar[3]" value="cc:title"/>
  <transform process="addDictRef" xpath="./cml:list/cml:list/cml:scalar[4]" value="cc:molecule"/>
  <transform process="addDictRef" xpath="./cml:list/cml:list/cml:scalar[5]" value="g:archive.namevalue"/>
  
    <!--  remove endmarker -->
  <transform process="delete" xpath="./cml:list/cml:list/cml:scalar[contains(.,'@') and string-length(.)=2]"/>
  <transform process="split" xpath="./cml:list/cml:list/cml:scalar" splitter="\\"/>
  <transform process="split" xpath="./cml:list/cml:list/cml:scalar[@dictRef='cc:keywords']" dictRef="g:keyword"/>
  
<!-- first line --> 
 
  <transform process="addDictRef" xpath=".//cml:list[@dictRef='g:archive1']/cml:scalar[3]" value="cc:hostname"/>
  <transform process="addDictRef" xpath=".//cml:list[@dictRef='g:archive1']/cml:scalar[4]" value="g:operation"/>
  <transform process="addDictRef" xpath=".//cml:list[@dictRef='g:archive1']/cml:scalar[5]" value="cc:method"/>
  <transform process="addDictRef" xpath=".//cml:list[@dictRef='g:archive1']/cml:scalar[6]" value="cc:basis"/>
  <transform process="addDictRef" xpath=".//cml:list[@dictRef='g:archive1']/cml:scalar[8]" value="cc:jobname"/>
  <transform process="createDate" xpath=".//cml:list[@dictRef='g:archive1']/cml:scalar[9]" format="dd-MMM-yyyy" dictRef="cc:date"/>
  <transform process="createFormula" xpath=".//cml:list[@dictRef='g:archive1']/cml:scalar[7]"/>
  <transform process="delete" xpath=".//cml:list[@dictRef='g:archive1']/cml:scalar[not(@dictRef)]"/>
  

<!--  additional lines -->  
  <transform process="createArray" xpath=".//cml:scalar[@dictRef='g:archive']" splitter="," from="." 
      dictRef="x:unknown" dataType="xsd:double"/>
 
  <transform process="pullup" xpath=".//cml:list[@dictRef='g:archive']"/>
<!--  molecule -->
  <transform process="createArray" xpath=".//cml:list[@dictRef='cc:molecule']/cml:scalar" from="." 
      splitter=","/>
  <transform process="split" xpath=".//cml:list[@dictRef='cc:molecule']/cml:array" from="." />
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='cc:molecule']/cml:list" name="type" value="molecule" />
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='cc:molecule']/cml:list[1]" name="type" value="chargemult" />

  <!-- mark with types (may be able to conflate this with createArray) -->  
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='cc:molecule']/cml:list[@type='molecule']" 
    from="./cml:scalar" fromPosition="1" name="dictRef" value="cc:elementType"/>
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='cc:molecule']/cml:list[@type='molecule']" 
    from="./cml:scalar" fromPosition="2" name="dictRef" value="cc:x3"/>
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='cc:molecule']/cml:list[@type='molecule']" 
    from="./cml:scalar" fromPosition="3" name="dictRef" value="cc:y3"/>
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='cc:molecule']/cml:list[@type='molecule']" 
    from="./cml:scalar" fromPosition="4" name="dictRef" value="cc:z3"/>
  <transform process="addAttribute" xpath=".//cml:list[@type='chargemult']" 
    from="./cml:scalar" fromPosition="1" name="dictRef" value="x:formalCharge"/>
  <transform process="addAttribute" xpath=".//cml:list[@type='chargemult']" 
    from="./cml:scalar" fromPosition="2" name="dictRef" value="x:spinMultiplicity"/>
     <!-- make arrays taking one from each row -->
  <transform process="createArray" xpath=".//cml:list[@dictRef='cc:molecule']" dataType="xsd:string" 
      from="./cml:list[@type='molecule']/cml:scalar[@dictRef='cc:elementType']"/>
  <transform process="createArray" xpath=".//cml:list[@dictRef='cc:molecule']" dataType="xsd:double" 
      from="./cml:list[@type='molecule']/cml:scalar[@dictRef='cc:x3']"/>
  <transform process="createArray" xpath=".//cml:list[@dictRef='cc:molecule']" dataType="xsd:double"
      from="./cml:list[@type='molecule']/cml:scalar[@dictRef='cc:y3']"/>
  <transform process="createArray" xpath=".//cml:list[@dictRef='cc:molecule']" dataType="xsd:double"
      from="./cml:list[@type='molecule']/cml:scalar[@dictRef='cc:z3']"/>
      <!--  createMolecule -->     
  <transform process="createMolecule" id="mol9999" xpath=".//cml:list[@type='molecule']/cml:array" from="."/>
  <transform process="addAttribute" id="mol9999" xpath=".//cml:molecule'" name="spinMultiplicity" 
      value="$number(.//cml:scalar[@dictRef='x:spinMultiplicity'])"/>
  <transform process="addAttribute" id="mol9999" xpath=".//cml:molecule'" name="formalCharge" 
      value="$number(.//cml:scalar[@dictRef='x:formalCharge'])"/>
  <transform process="delete" xpath=".//cml:list[@type='chargemult']"/> 
  <transform process="pullup" xpath=".//cml:molecule" repeat="2"/> 

<!-- nameValue pairs -->  
  <transform process="createNameValue" regex="\s*(.*)\s*=\s*(.*)\s*" xpath=".//cml:list[@dictRef='g:archive.namevalue']/cml:scalar"/>
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='g:archive.namevalue']/cml:scalar[@dictRef='x:Version']" name="dictRef" value="cc:version"/>
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='g:archive.namevalue']/cml:scalar[@dictRef='x:State']" name="dictRef" value="cc:electronicstate"/>
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='g:archive.namevalue']/cml:scalar[@dictRef='x:NImag']" name="dictRef" value="g:nimag"/>
  <transform process="addAttribute" xpath=".//cml:list[@dictRef='g:archive.namevalue']/cml:scalar[@dictRef='x:PG']" name="dictRef" value="cc:pointgroup"/>
  <transform process="createDouble" xpath=".//cml:list[@dictRef='g:archive.namevalue']/cml:scalar[@dictRef='x:HF']" dictRef="cc:hfenergy"/>
  <transform process="createDouble" xpath=".//cml:list[@dictRef='g:archive.namevalue']/cml:scalar[@dictRef='x:RMSD']" dictRef="cc:rmsd"/>
  <transform process="createDouble" xpath=".//cml:list[@dictRef='g:archive.namevalue']/cml:scalar[@dictRef='x:RMSF']" dictRef="cc:rmsf"/>
  
  <transform process="createArray" xpath=".//cml:scalar[@dictRef='x:Dipole']" 
    splitter="," from="." dictRef="cc:dipole" dataType="xsd:double"/>
  <transform process="createArray" xpath=".//cml:scalar[@dictRef='x:DipoleDeriv']" 
    splitter="," from="." dictRef="cc:dipolederiv" dataType="xsd:double"/>
  <transform process="createArray" xpath=".//cml:scalar[@dictRef='x:Polar']" 
    delimiter="|" splitter="," from="." dictRef="cc:polarizability" dataType="xsd:double"/>
     
  <!-- tidy -->
  <transform process="pullup" xpath=".//cml:list[@dictRef='g:archive1']/*"/>
  <transform process="pullup" xpath=".//cml:list[@dictRef='g:archive.namevalue']/*"/>
  <transform process="pullup" xpath="./cml:list[@dictRef='g:archive']/*"/>
  <transform process="pullup" xpath="./cml:list/*"/>
  <transform process="addDictRef" xpath="./cml:molecule/cml:formula" value="cc:formula.calc"/>
  <transform process="addDictRef" xpath="./cml:formula" value="cc:formula.user"/>
  <transform process="move" xpath=".//cml:formula[@dictRef='cc:formula.user']" toXpath=".//cml:molecule"/>
  <transform process="delete" xpath=".//*[@dictRef='g:nimag']"/>
  <transform process="delete" xpath=".//cml:formula/cml:atomArray"/>
  
  <transform process="addUnits" xpath=".//cml:scalar[@dictRef='cml:molmass']"      value="nonsi:dalton"/>
  <transform process="addUnits" xpath=".//cml:scalar[@dictRef='cc:hfenergy']"      value="nonsi:hartree"/>
  <transform process="addUnits" xpath=".//cml:scalar[@dictRef='cc:rmsd']"          value="nonsi:unknown"/>
  <transform process="addUnits" xpath=".//cml:scalar[@dictRef='cc:rmsf']"          value="nonsi:unknown"/>
  <transform process="addUnits" xpath=".//cml:array[@dictRef='cc:dipole']"         value="nonsi:debye"/>
  <transform process="addUnits" xpath=".//cml:array[@dictRef='cc:dipolederiv']"    value="nonsi:unknown"/>
  <transform process="addUnits" xpath=".//cml:array[@dictRef='cc:polarizability']" value="nonsi:unknown"/>
  <transform process="addUnits" xpath=".//cml:property[@dictRef='x:unknown']"      value="nonsi:unknown"/>


  <comment class="example.output" id="l9999.archive">
<module cmlx:templateRef="l9999.archive" xmlns="http://www.xml-cml.org/schema" xmlns:cmlx="http://www.xml-cml.org/schema/cmlx">
  <scalar dataType="xsd:string" dictRef="cc:hostname">GINC-DEEPTHOUGHT</scalar>
  <scalar dataType="xsd:string" dictRef="g:operation">Freq</scalar>
  <scalar dataType="xsd:string" dictRef="cc:method">RB3LYP</scalar>
  <scalar dataType="xsd:string" dictRef="cc:basis">6-31G(d)</scalar>
  <scalar dataType="xsd:string" dictRef="cc:jobname">WWW-DATA</scalar>
  <scalar dataType="xsd:date" dictRef="cc:date">2006-11-20T00:00:00Z</scalar>
  <scalar dataType="xsd:string" dictRef="g:keyword">#N</scalar>
  <scalar dataType="xsd:string" dictRef="g:keyword">GEOM=ALLCHECK</scalar>
  <scalar dataType="xsd:string" dictRef="g:keyword">GUESS=READ</scalar>
  <scalar dataType="xsd:string" dictRef="g:keyword">SCRF=CHECK</scalar>
  <scalar dataType="xsd:string" dictRef="g:keyword">GENCHK</scalar>
  <scalar dataType="xsd:string" dictRef="g:keyword">RB3LYP/6-31G(D)</scalar>
  <scalar dataType="xsd:string" dictRef="g:keyword">FREQ</scalar>
  <scalar dataType="xsd:string" dictRef="cc:title">CH4</scalar>
  <molecule id="mol9999" spinMultiplicity="1" formalCharge="0">
    <atomArray>
      <atom id="a1" elementType="C" x3="0.0" y3="0.0" z3="0.0">
        <scalar dataType="xsd:integer" dictRef="compchem:atomicNumber">6</scalar>
      </atom>
      <atom id="a2" elementType="H" x3="9.95E-8" y3="1.925E-7" z3="1.09326594">
        <scalar dataType="xsd:integer" dictRef="compchem:atomicNumber">1</scalar>
      </atom>
      <atom id="a3" elementType="H" x3="1.0307409799" y3="1.096E-7" z3="-0.3644220738">
        <scalar dataType="xsd:integer" dictRef="compchem:atomicNumber">1</scalar>
      </atom>
      <atom id="a4" elementType="H" x3="-0.5153703892" y3="-0.8926480531" z3="-0.3644217759">
        <scalar dataType="xsd:integer" dictRef="compchem:atomicNumber">1</scalar>
      </atom>
      <atom id="a5" elementType="H" x3="-0.5153706902" y3="0.892647751" z3="-0.3644220902">
        <scalar dataType="xsd:integer" dictRef="compchem:atomicNumber">1</scalar>
      </atom>
    </atomArray>
    <formula formalCharge="0" concise="C 1 H 4" dictRef="cc:formula.calc"/>
    <bondArray>
      <bond atomRefs2="a1 a2" id="a1_a2" order="S"/>
      <bond atomRefs2="a1 a3" id="a1_a3" order="S"/>
      <bond atomRefs2="a1 a4" id="a1_a4" order="S"/>
      <bond atomRefs2="a1 a5" id="a1_a5" order="S"/>
    </bondArray>
    <property dictRef="cml:molmass">
      <scalar dataType="xsd:double" units="unit:dalton" xmlns:unit="http://www.xml-cml.org/unit/si/">16.04246</scalar>
    </property>
    <!-- 
    <formula concise="C 1 H 4" dictRef="cc:formula.user"/>
    -->
  </molecule>
  <scalar dataType="xsd:string" dictRef="cc:version">x86-Linux-G03RevB.04</scalar>
  <scalar dataType="xsd:string" dictRef="cc:electronicstate">1-A1</scalar>
  <scalar dataType="xsd:double" dictRef="cc:hfenergy" units="nonsi:hartree">-40.5183892</scalar>
  <scalar dataType="xsd:double" dictRef="cc:rmsd" units="nonsi:unknown">8.723E-11</scalar>
  <scalar dataType="xsd:double" dictRef="cc:rmsf" units="nonsi:unknown">8.224E-8</scalar>
  <array dataType="xsd:double" size="3" dictRef="cc:dipole" units="nonsi:debye">0.0 0.0 0.0</array>
  <array dataType="xsd:double" size="45" dictRef="cc:dipolederiv" units="nonsi:unknown">7.872E-4 0.0 0.0 0.0 7.871E-4 0.0 0.0 0.0 7.871E-4 0.0733391 0.0 0.0 0.0 0.0733391 0.0 0.0 0.0 -0.1472685 -0.1227565 0.0 0.0693303 0.0 0.0733391 0.0 0.0693303 0.0 0.0488271 0.0243152 -0.0849119 -0.0346651 -0.0849119 -0.0737327 -0.0600418 -0.0346651 -0.0600418 0.0488271 0.0243151 0.0849119 -0.0346652 0.0849119 -0.0737326 0.0600418 -0.0346652 0.0600418 0.0488271</array>
  <array dataType="xsd:double" size="6" dictRef="cc:polarizability" units="nonsi:unknown">12.3528403 0.0 12.3528403 0.0 0.0 12.3528403</array>
  <scalar dataType="xsd:string" dictRef="cc:pointgroup">TD [O(C1),4C3(H1)]</scalar>
  <array dataType="xsd:double" size="120" dictRef="x:unknown">0.55936081 0.0 0.55936081 0.0 0.0 0.55936081 -0.0482856 0.0 -3.0E-8 0.04683066 0.0 -0.0482856 -5.0E-8 0.0 0.04683066 -3.0E-8 -5.0E-8 -0.32294941 3.0E-8 5.0E-8 0.34888521 -0.29243119 -3.0E-8 0.08631853 0.00266595 0.0 -6.7139E-4 0.31532358 -3.0E-8 -0.0482856 0.0 0.0 -0.00169598 0.0 3.0E-8 0.04683066 0.08631853 0.0 -0.07880382 0.03266432 0.0 -0.00864527 -0.09492661 -1.0E-8 0.08039229 -0.10932197 -0.10571814 -0.04315922 -6.055E-4 0.00188877 3.357E-4 -0.01277916 -0.02604072 -0.01202812 0.11395386 -0.10571814 -0.23139487 -0.07475399 0.00188877 0.00157546 5.8144E-4 0.00117778 0.00157546 0.00158693 0.11626084 0.24820043 -0.04315922 -0.07475399 -0.07880377 -0.01633216 -0.02828814 -0.00864526 0.00463974 0.01121013 0.00352839 0.04746326 0.0822088 0.08039224 -0.10932205 0.10571817 -0.04315928 -6.055E-4 -0.00188877 3.357E-4 -0.01277917 0.02604071 -0.01202812 0.00875278 -0.01360924 0.00738839 0.11395394 0.10571817 -0.23139475 0.07475403 -0.00188877 0.00157547 -5.8144E-4 -0.00117778 0.00157546 -0.00158694 0.01360926 -0.01995648 0.0096232 -0.11626087 0.24820029 -0.04315928 0.07475403 -0.07880382 -0.01633217 0.02828813 -0.00864527 0.00463974 -0.01121013 0.0035284 0.00738838 -0.00962319 0.00352839 0.04746332 -0.08220885 0.0803923</array>
  <array dataType="xsd:double" size="15" dictRef="x:unknown">0.0 0.0 0.0 0.0 0.0 1.6E-7 1.5E-7 0.0 -5.0E-8 -8.0E-8 -1.3E-7 -5.0E-8 -8.0E-8 1.3E-7 -5.0E-8</array>
</module>
  </comment>
  
</template>
 