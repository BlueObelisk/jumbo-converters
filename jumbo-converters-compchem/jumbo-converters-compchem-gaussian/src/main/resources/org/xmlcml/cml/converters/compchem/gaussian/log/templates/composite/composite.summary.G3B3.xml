<template
  id="composite.summary.G3B3"
  name="Composite Method G3B3 - Summary"
  repeat="*"
  newline="$" 
  pattern="\s*Temperature=.+$.+$.+$.+$.+$.+$.+$\s+1\\1\\GINC.+\\Mixed\\G3B3\\.+"
  offset="0"
  endPattern=".+\\.+"
  endOffset="-1"
  xmlns:xi="http://www.w3.org/2001/XInclude">

  <comment class="example.input" id="composite.summary.G3B3">
 Temperature=              298.150000 Pressure=                      1.000000
 E(ZPE)=                     0.049416 E(Thermal)=                    0.052738
 E(QCISD(T))=             -115.374849 E(Empiric)=                   -0.047320
 DE(Plus)=                  -0.012074 DE(2DF)=                      -0.109911
 E(Delta-G3)=               -0.136986 E(G3-Empiric)=                -0.047320
 G3(0 K)=                 -115.631725 G3 Energy=                  -115.628404
 G3 Enthalpy=             -115.627459 G3 Free Energy=             -115.654462
  </comment>

  <record id="G3B3.Temp.Press"     repeat="1">\s*Temperature=\s*{F,cc:temperature}\s+Pressure=\s*{F,cc:pressure}\s*</record>
  <record id="G3B3.contributions1" repeat="1">\s*E\(ZPE\)=\s*{F,g:E_ZPE}\s+E\(Thermal\)=\s*{F,g:E_Thermal}\s*</record>
  <record id="G3B3.contributions2" repeat="1">\s*E\(QCISD\(T\)\)=\s*{F,g:E_QCISD_T}\s+E\(Empiric\)=\s*{F,g:E_Empiric}\s*</record>
  <record id="G3B3.contributions3" repeat="1">\s*DE\(Plus\)=\s*{F,g:DE_Plus}\s+DE\(2DF\)=\s*{F,g:DE_2DF}\s*</record>
  <record id="G3B3.contributions4" repeat="1">\s*E\(Delta-G3\)=\s*{F,g:E_Delta-G3B3}\s+E\(G3-Empiric\)=\s*{F,g:E_G3B3-Empiric}\s*</record>
  <record id="G3B3a"               repeat="1">\s*G3\(0 K\)=\s*{F,g:Energy_G3B3_0K}\s+G3 Energy=\s*{F,g:Energy_G3B3}\s*$</record>
  <record id="G3B3b"               repeat="1">\s*G3 Enthalpy=\s*{F,g:Enthalpy_G3B3}\s+G3 Free Energy=\s*{F,g:GibbsEnergy_G3B3}\s*</record>

  <!-- Pull up scalars -->
  <transform process="pullup" xpath=".//cml:list/cml:scalar[@dictRef]" repeat="2" />

  <!-- Delete empty lists -->
  <transform process="delete" xpath=".//cml:list[count(*)=0]"/>
  <transform process="delete" xpath=".//cml:list[count(*)=0]"/>

  <!-- Improve some dictrefs -->
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:E_ZPE']"            value="cc:Energy_ZPVE"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:E_Thermal']"        value="cc:thermalCorrectionToEnergy"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:Energy_G3B3_0K']"   value="cc:Energy_0K"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:Energy_G3B3']"      value="cc:Energy_T"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:Enthalpy_G3B3']"    value="cc:Enthalpy_T"/>
  <transform process="addDictRef" xpath="./cml:scalar[@dictRef='g:GibbsEnergy_G3B3']" value="cc:GibbsEnergy_T"/>

  <!-- Add units -->
  <transform process="addUnits" xpath="./cml:scalar[@dictRef]" value="nonSi:hartree"/>
  <transform process="addUnits" xpath="./cml:scalar[@dictRef='cc:temperature']" value="si:kelvin"/>
  <transform process="addUnits" xpath="./cml:scalar[@dictRef='cc:pressure']" value="nonSi:atm"/>

  <!-- separate parameters and properties -->
  <transform process="addChild" elementName="cml:parameterList" xpath="." position="0" />
  <transform process="addChild" elementName="cml:propertyList" xpath="." position="1" />

  <transform process="move" xpath="./cml:scalar[@dictRef='method' or @dictRef='cc:temperature' or @dictRef='cc:pressure']" to="./cml:parameterList" />
  <transform process="move" xpath="./cml:scalar[contains(@dictRef,'cc:') or contains(@dictRef,'g:')]"                      to="./cml:propertyList" />

  <transform process="createWrapperParameter" xpath="./cml:parameterList/cml:scalar" />
  <transform process="createWrapperProperty"  xpath="./cml:propertyList/cml:scalar" />

  <comment class="example.output" id="composite.summary.G3B3">
    <module xmlns="http://www.xml-cml.org/schema" xmlns:cmlx="http://www.xml-cml.org/schema/cmlx" cmlx:templateRef="composite.summary.G3B3">
      <parameterList>
        <parameter dictRef="cc:temperature">
          <scalar dataType="xsd:double" units="si:kelvin">298.15</scalar>
        </parameter>
        <parameter dictRef="cc:pressure">
          <scalar dataType="xsd:double" units="nonSi:atm">1.0</scalar>
        </parameter>
      </parameterList>
      <propertyList>
        <property dictRef="cc:Energy_ZPVE">
          <scalar dataType="xsd:double" units="nonSi:hartree">0.049416</scalar>
        </property>
        <property dictRef="cc:thermalCorrectionToEnergy">
          <scalar dataType="xsd:double" units="nonSi:hartree">0.052738</scalar>
        </property>
        <property dictRef="g:E_QCISD_T">
          <scalar dataType="xsd:double" units="nonSi:hartree">-115.374849</scalar>
        </property>
        <property dictRef="g:E_Empiric">
          <scalar dataType="xsd:double" units="nonSi:hartree">-0.04732</scalar>
        </property>
        <property dictRef="g:DE_Plus">
          <scalar dataType="xsd:double" units="nonSi:hartree">-0.012074</scalar>
        </property>
        <property dictRef="g:DE_2DF">
          <scalar dataType="xsd:double" units="nonSi:hartree">-0.109911</scalar>
        </property>
        <property dictRef="g:E_Delta-G3B3">
          <scalar dataType="xsd:double" units="nonSi:hartree">-0.136986</scalar>
        </property>
        <property dictRef="g:E_G3B3-Empiric">
          <scalar dataType="xsd:double" units="nonSi:hartree">-0.04732</scalar>
        </property>
        <property dictRef="cc:Energy_0K">
          <scalar dataType="xsd:double" units="nonSi:hartree">-115.631725</scalar>
        </property>
        <property dictRef="cc:Energy_T">
          <scalar dataType="xsd:double" units="nonSi:hartree">-115.628404</scalar>
        </property>
        <property dictRef="cc:Enthalpy_T">
          <scalar dataType="xsd:double" units="nonSi:hartree">-115.627459</scalar>
        </property>
        <property dictRef="cc:GibbsEnergy_T">
          <scalar dataType="xsd:double" units="nonSi:hartree">-115.654462</scalar>
        </property>
      </propertyList>
    </module>
  </comment>

</template>