<transformList>

<!--  tidy frequencies -->
  <transform process="addDictRef" xpath="//cml:property[cml:module[@cmlx:templateRef='l716.forcematrix']]"
    value="cc:frequencies"/>
  <transform process="pullup" xpath="//cml:property[@dictRef='cc:frequencies']//cml:table" repeat="2" />
  <!-- <transform process="addChild" xpath="//cml:property[cml:module[@cmlx:templateRef='l716.forcematrix']]"
    elementName="cml:list" id="l716.forcematrix"/>
  <transform process="moveRelative" xpath="//cml:property[@dictRef='cc:frequencies']/cml:module[@cmlx:templateRef='l716.forcematrix']/cml:module[@cmlx:templateRef='l716.freq.chunkx']/cml:array" 
             to="../../../cml:list[@id='l716.forcematrix']" />
  <transform process="createTable" xpath=".//cml:list[@id='l716.forcematrix']" /> 

  <transform process="addAttribute" xpath=".//cml:property[@dictRef='cc:frequencies']/cml:table" name="rows" value="$number(./cml:arrayList/cml:array/@size)" />
  <transform process="addAttribute" xpath=".//cml:property[@dictRef='cc:frequencies']/cml:table" name="columns" value="6" />
-->

  <transform process="pullupSingleton" xpath=".//cml:module[@cmlx:templateRef='l716.lowfreq']"/>
  <transform process="pullupSingleton" xpath=".//cml:module[@cmlx:templateRef='l716.diagvib']"/>
  
  <transform process="createWrapperProperty"
             xpath=".//cml:array[@dictRef='g:l716.lowfreq' or @dictRef='cc:diagvib' ]"/>
  <transform process="pullup"
             xpath=".//cml:property[@dictRef='g:l716.lowfreq' or @dictRef='cc:diagvib' ]" repeat="2"/>
             
   
<!--  tidy thermochemistry -->
  <transform process="addDictRef" xpath="//cml:property[cml:module[@cmlx:templateRef='l716.thermochemistry']]"
    value="cc:thermochemistry"/>
  <transform process="addChild" xpath="//cml:property[cml:module[@cmlx:templateRef='l716.thermochemistry']]"
    elementName="cml:list" id="l716.thermochemistry"/>
  <transform process="moveRelative" xpath="//cml:property[@dictRef='cc:thermochemistry']/cml:module/cml:*" to="../../cml:list"/>
   
<!--  tidy zeropoint -->
  <transform process="addDictRef" xpath="//cml:property[cml:module[@cmlx:templateRef='l716.thermochemistry.energies']]"
    value="cc:thermochemistry.energies"/>
  <transform process="addChild" xpath="//cml:property[cml:module[@cmlx:templateRef='l716.thermochemistry.energies']]"
    elementName="cml:list" id="l716.thermochemistry.energies"/>
  <transform process="moveRelative" xpath="//cml:property[@dictRef='cc:thermochemistry.energies']/cml:module/cml:scalar" to="../../cml:list"/>
   
<!--  tidy displacements -->
  <transform process="pullup" xpath=".//cml:module[@cmlx:templateRef='l716.freq.chunkx']" repeat="2" />
  <transform process="addChild" elementName="cml:property" xpath=".//cml:module[@id='finalization']/cml:propertyList" dictRef='cc:vibrations' />
  <transform process="moveRelative" xpath=".//cml:module[@id='finalization']//cml:module[@cmlx:templateRef='l716.freq.chunkx']" to="./ancestor::cml:propertyList/cml:property[@dictRef='cc:vibrations']" />
  <transform process="split" xpath=".//cml:property[@dictRef='cc:vibrations']/cml:module/cml:array[@dictRef='cc:displacement']"
    rows="$number(../cml:array[@dictRef='cc:atomicNumber']/@size)"/>
  <transform process="copy" xpath=".//cml:property[@dictRef='cc:vibrations']//cml:array[@dictRef='cc:displacement']"
    to="./ancestor::cml:module[@dictRef='cc:finalization']/cml:molecule[@id='mol9999']/cml:atomArray/cml:atom" />
  <transform process="split" xpath=".//cml:array[@dictRef='cc:displacement']" cols="3"/>
  <transform process="addChild" xpath=".//cml:module[@id='finalization']//cml:property[cml:module[@cmlx:templateRef='l716.freq.chunkx']]" elementName="cml:scalar" dictRef="cc:linkToAtoms" 
    value="./ancestor::cml:module[@dictRef='cc:finalization']/cml:molecule[@id='mol9999']"/>
  <transform process="delete" xpath=".//cml:property[@dictRef='cc:vibrations']/cml:module[@cmlx:templateRef='l716.freq.chunkx']"/>
  <transform process="createWrapperProperty" xpath=".//cml:module[@dictRef='cc:finalization']/cml:molecule[@id='mol9999']//cml:list[cml:array[@dictRef='cc:displacement']]" 
    dictRef="cc:vibdisplacements"/>

<!--  tidy forces -->
  <transform process="addDictRef" xpath="//cml:property[cml:module[@cmlx:templateRef='l716.forces']]"
    value="cc:forces"/>
  <transform process="copy" xpath="//cml:property[@dictRef='cc:forces']//cml:array[@dictRef='cc:force']"
    to="./ancestor::cml:module[@dictRef='cc:finalization']/cml:molecule[@id='mol9999']/cml:atomArray/cml:atom"/>
  <transform process="delete" xpath=".//cml:property[.//@dictRef='cc:forces']/cml:*"/>
  <transform process="addChild" xpath=".//cml:property[@dictRef='cc:forces']" elementName="cml:scalar" dictRef="cc:linkToAtoms" 
    value="./ancestor::cml:module[@dictRef='cc:finalization']/cml:molecule[@id='mol9999']"/>
  <transform process="createWrapperProperty" dictRef="cc:force"
    xpath=".//cml:module[@dictRef='cc:finalization']/cml:molecule[@id='mol9999']//cml:array[@dictRef='cc:force']" />
  
</transformList> 