<template id="thermochemistry"
  repeat="*"
  name="thermochemistry"
  pattern="\s*STANDARD THERMODYNAMIC QUANTITIES AT.+"      offset="0"
  endPattern="\s*Total Entropy:.+"   endOffset="1" >

  <comment class="example.input" id="thermochemistry">
 STANDARD THERMODYNAMIC QUANTITIES AT   298.18 K  AND     1.00 ATM

   This Molecule has  0 Imaginary Frequencies
   Zero point vibrational energy:       29.979 kcal/mol

   Atom    1 Element C  Has Mass   12.00000
   Atom    2 Element H  Has Mass    1.00783
   Atom    3 Element H  Has Mass    1.00783
   Atom    4 Element H  Has Mass    1.00783
   Atom    5 Element H  Has Mass    1.00783
   Molecular Mass:    16.031320 amu
   Principal axes and moments of inertia in atomic units:
                             1           2           3
    Eigenvalues --       11.27121    11.27121    11.27121
          X               0.70711     0.40825    -0.57735
          Y               0.70711    -0.40825     0.57735
          Z               0.00000     0.81650     0.57735
   Rotational Symmetry Number is  12
   The Molecule is a Spherical Top
   Translational Enthalpy:        0.889 kcal/mol
   Rotational Enthalpy:           0.889 kcal/mol
   Vibrational Enthalpy:         29.991 kcal/mol
   gas constant (RT):             0.593 kcal/mol
   Translational Entropy:        34.262  cal/mol.K
   Rotational Entropy:           10.085  cal/mol.K
   Vibrational Entropy:           0.047  cal/mol.K

   Total Enthalpy:               32.361 kcal/mol
   Total Entropy:                44.394  cal/mol.K
  </comment>

  <!-- RECORD -->
  <record id="thermochemistry">\s*STANDARD THERMODYNAMIC QUANTITIES AT\s+{F,cc:temp} K\s+AND\s+{F,cc:press} ATM\s*</record>
  <record id="thermochemistry.unparsed" repeat="2" />
  <record id="thermochemistry">\s*Zero point vibrational energy:\s+{F,cc:zpe}.*</record>
  <record id="thermochemistry.unparsed" />
  <record id="mass" makeArray="true" repeat="*">\s*Atom\s+{I,cc:serial}\s+Element\s+{A,cc:elementType}\s+Has Mass\s+{F,cc:atomicmass}\s*</record>
  <record id="molmass">\s*Molecular Mass:\s+{F,cc:molmass}\s+.*</record>
  <record id="thermochemistry.unparsed" repeat="2" />
  <record id="principalAxes">\s*Eigenvalues\s+--\s+{F,cc:principalAxesEigenval}\s+{F,cc:principalAxesEigenval}\s+{F,cc:principalAxesEigenval}\s*</record>
  <record id="principalAxes2" makeArray="true" repeat="*">\s+.\s+{F,cc:principalcomp}\s+{F,cc:principalcomp}\s+{F,cc:principalcomp}\s*</record>
  <record id="symmnumber">\s*Rotational Symmetry Number is {I,cc:symmnumber}\s*</record>
  <record id="top">\s*The Molecule is a {A,q:top} Top\s*</record>
  <record id="transEnthalpy">\s*Translational Enthalpy:\s+{F,q:transEnthalpy}.*</record>
  <record id="rotEnthalpy">\s*Rotational Enthalpy:\s+{F,q:rotEnthalpy}.*</record>
  <record id="vibEnthalpy">\s*Vibrational Enthalpy:\s+{F,q:vibEnthalpy}.*</record>
  <record id="gasConstant">\s*gas constant \(RT\):\s+{F,q:gasConstant}.*</record>
  <record id="transEntropy">\s*Translational Entropy:\s+{F,q:transEntropy}.*</record>
  <record id="rotEntropy">\s*Rotational Entropy:\s+{F,q:rotEntropy}.*</record>
  <record id="vibEntropy">\s*Vibrational Entropy:\s+{F,q:vibEntropy}.*</record>
  <record id="thermochemistry.unparsed" />
  <record id="totalEnthalpy">\s*Total Enthalpy:\s+{F,cc:thermalCorrectionToEnthalpy}.*</record>
  <record id="totalEntropy">\s*Total Entropy:\s+{F,q:totalEntropy}.*</record>

  <!-- TRANSFORM -->
  <transform process="addUnits" xpath=".//*[@dictRef='cc:temp']"                                         value="si:k" />
  <transform process="addUnits" xpath=".//*[@dictRef='cc:press']"                                        value="nonSi:atm" />
  <transform process="addUnits" xpath=".//*[@dictRef='cc:zpe']"                                          value="nonSi:kcal.mol-1" />
  <transform process="addUnits" xpath=".//*[@dictRef='cc:molmass' or @dictRef='cc:atomicmass']"          value="nonSi:dalton" />
  <transform process="addUnits" xpath=".//*[contains(@dictRef,'Enthalpy') or @dictRef='q:gasConstant']"  value="nonSi:kcal.mol-1" />
  <transform process="addUnits" xpath=".//*[contains(@dictRef,'Entropy')]"                               value="nonSi:cal.mol-1.k-1" />

  <transform process="createArray" xpath="." from=".//cml:scalar[@dictRef='cc:principalAxesEigenval']" />
  <transform process="createTable" xpath=".//*[@cmlx:templateRef='mass']" />
  <transform process="pullup" xpath=".//cml:list/cml:list/cml:scalar[contains(@dictRef,'cc') or contains(@dictRef,'q')]" />
  <transform process="pullup" xpath=".//cml:list/cml:scalar[contains(@dictRef,'cc') or contains(@dictRef,'q')]" />
  <transform process="pullup" xpath=".//cml:list/cml:list/cml:array[contains(@dictRef,'cc') or contains(@dictRef,'q')]" />
  <transform process="pullup" xpath=".//cml:list/cml:array[contains(@dictRef,'cc') or contains(@dictRef,'q')]" />
  <transform process="addDictRef" xpath=".//cml:table" value="cc:atomicmass" />
  <transform process="createWrapperParameter" xpath=".//cml:scalar[@dictRef='cc:temp' or @dictRef='cc:press']" />
  <transform process="createWrapperParameter" xpath=".//cml:table[@dictRef='cc:atomicmass']" />
  <transform process="addChild"
             xpath="."
             elementName="cml:parameterList"
             position="0" />
  <transform process="move" xpath=".//cml:parameter" to=".//cml:parameterList" />
  <transform process="addChild"
             xpath="."
             elementName="cml:list"
             dictRef="cc:principalAxes"
             position="7" />
  <transform process="move" xpath=".//cml:array[contains(@dictRef,'cc:principal')]" to=".//cml:list[@dictRef='cc:principalAxes']" />
  <transform process="createWrapperProperty" xpath=".//cml:scalar[contains(@dictRef,'cc') or contains(@dictRef,'q')]" />
  <transform process="createWrapperProperty" xpath=".//cml:list[@dictRef='cc:principalAxes']" />
  <transform process="addChild"
             xpath="."
             elementName="cml:propertyList"
             position="1" />
  <transform process="move" xpath=".//cml:property" to=".//cml:propertyList" />


  <!-- CLEAN UP -->
  <transform process="delete" xpath=".//cml:list[count(*)=0]" />
  <transform process="delete" xpath=".//cml:list[count(*)=0]" />

  <comment class="example.output" id="thermochemistry">
    <module cmlx:templateRef="thermochemistry" xmlns="http://www.xml-cml.org/schema" xmlns:cmlx="http://www.xml-cml.org/schema/cmlx">
      <parameterList>
        <parameter dictRef="cc:temp">
          <scalar dataType="xsd:double" units="si:k">298.18</scalar>
        </parameter>
        <parameter dictRef="cc:press">
          <scalar dataType="xsd:double" units="nonSi:atm" >1.0</scalar>
        </parameter>
        <parameter dictRef="cc:atomicmass">
          <table tableType="columnBased">
            <arrayList>
              <array dataType="xsd:integer" dictRef="cc:serial" size="5">1 2 3 4 5</array>
              <array dataType="xsd:string" dictRef="cc:elementType" size="5">C H H H H</array>
              <array dataType="xsd:double" dictRef="cc:atomicmass" size="5" units="nonSi:dalton">12.0 1.00783 1.00783 1.00783 1.00783</array>
            </arrayList>
          </table>
        </parameter>
      </parameterList>
      <propertyList>
        <property dictRef="cc:zpe">
          <scalar dataType="xsd:double" units="nonSi:kcal.mol-1">29.979</scalar>
        </property>
        <property dictRef="cc:molmass">
          <scalar dataType="xsd:double" units="nonSi:dalton">16.03132</scalar>
        </property>
        <property dictRef="cc:principalAxes">
          <list>
            <array dataType="xsd:double"  dictRef="cc:principalAxesEigenval" size="3">11.27121 11.27121 11.27121</array>
            <array dataType="xsd:double"  dictRef="cc:principalcomp" size="3">0.70711 0.70711 0.0</array>
            <array dataType="xsd:double"  dictRef="cc:principalcomp" size="3">0.40825 -0.40825 0.8165</array>
            <array dataType="xsd:double"  dictRef="cc:principalcomp" size="3">-0.57735 0.57735 0.57735</array>
          </list>
        </property>
        <property dictRef="cc:symmnumber">
          <scalar dataType="xsd:integer">12</scalar>
        </property>
        <property dictRef="q:top">
          <scalar dataType="xsd:string">Spherical</scalar>
        </property>
        <property dictRef="q:transEnthalpy">
          <scalar dataType="xsd:double" units="nonSi:kcal.mol-1">0.889</scalar>
        </property>
        <property dictRef="q:rotEnthalpy">
          <scalar dataType="xsd:double" units="nonSi:kcal.mol-1">0.889</scalar>
        </property>
        <property dictRef="q:vibEnthalpy">
          <scalar dataType="xsd:double" units="nonSi:kcal.mol-1">29.991</scalar>
        </property>
        <property dictRef="q:gasConstant">
          <scalar dataType="xsd:double" units="nonSi:kcal.mol-1">0.593</scalar>
        </property>
        <property dictRef="q:transEntropy">
          <scalar dataType="xsd:double" units="nonSi:cal.mol-1.k-1">34.262</scalar>
        </property>
        <property dictRef="q:rotEntropy">
          <scalar dataType="xsd:double" units="nonSi:cal.mol-1.k-1">10.085</scalar>
        </property>
        <property dictRef="q:vibEntropy">
          <scalar dataType="xsd:double" units="nonSi:cal.mol-1.k-1">0.047</scalar>
        </property>
        <property dictRef="cc:thermalCorrectionToEnthalpy">
          <scalar dataType="xsd:double" units="nonSi:kcal.mol-1">32.361</scalar>
        </property>
        <property dictRef="q:totalEntropy">
          <scalar dataType="xsd:double" units="nonSi:cal.mol-1.k-1">44.394</scalar>
        </property>
      </propertyList>
    </module>
  </comment>

</template>
